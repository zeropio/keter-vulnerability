import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import Swal from 'sweetalert2';
@Component({
  selector: 'app-xxe1',
  templateUrl: './xxe1.component.html',
  styleUrls: ['./xxe1.component.css'],
})
export class Xxe1Component implements OnInit {
  newsForm: FormGroup;

  constructor(private fb: FormBuilder) {
    this.newsForm = this.fb.group({
      source: ['', Validators.required],
    });
  }

  ngOnInit(): void {
    console.clear();
    console.info('That XML looks suspicious...');
  }

  news() {
    let source = this.newsForm.value.source;

    if (source.includes('<!ENTITY') && source.includes('SYSTEM')) {
      Swal.fire({
        icon: 'success',
        title: 'Congrats, challenge complete!',
        text: 'You have found the vulnerability',
      });
    }
  }
}
